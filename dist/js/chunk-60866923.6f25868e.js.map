{"version":3,"sources":["webpack:///./src/api/rank.js","webpack:///./src/components/rank/rank.vue?dc38","webpack:///src/components/rank/rank.vue","webpack:///./src/components/rank/rank.vue?37a0","webpack:///./src/components/rank/rank.vue","webpack:///./src/components/rank/rank.vue?5155"],"names":["getTopList","url","data","Object","assign","commonParams","g_tk","format","platform","needNewCode","uin","commonInfo","commonData","Promise","resolve","reject","tryTime","request","axios","post","comm","req_0","then","response","res","code","ERR_OK","retry","Error","module","method","param","getMusicList","topid","tpl","page","type","jsonp","options","render","_vm","this","_h","$createElement","_c","_self","ref","staticClass","attrs","topList","_l","item","index","key","on","$event","selectItem","directives","name","rawName","value","expression","_v","_s","title","info","singerName","length","staticRenderFns","mixins","created","_getTopList","methods","handlePlaylist","$refs","rank","style","bottom","toplist","refresh","$router","push","path","setTopList","topListGroup","forEach","ret","list","filter","array","topId","components","Scroll","Loading","component"],"mappings":"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","file":"js/chunk-60866923.6f25868e.js","sourcesContent":["import {\r\n  commonParams,\r\n  options\r\n} from './config'\r\nimport axios from 'axios'\r\nimport {\r\n  ERR_OK\r\n} from 'api/config'\r\nimport jsonp from 'common/js/jsonp'\r\n\r\nexport function getTopList() {\r\n  const url = '/api/getCommonInfo'\r\n\r\n  const data = Object.assign({}, commonParams, {\r\n    g_tk: 5381,\r\n    format: 'json',\r\n    platform: 'h5',\r\n    needNewCode: 1,\r\n    uin: 0\r\n  })\r\n\r\n  const commonInfo = commonData('musicToplist.ToplistInfoServer', 'GetAll', {})\r\n\r\n  return new Promise((resolve, reject) => {\r\n    let tryTime = 3\r\n\r\n    function request() {\r\n      return axios.post(url, {\r\n        comm: data,\r\n        req_0: commonInfo\r\n      }).then((response) => {\r\n        const res = response.data\r\n        if (res.code === ERR_OK) {\r\n          resolve(res)\r\n        } else {\r\n          retry()\r\n        }\r\n      })\r\n    }\r\n\r\n    function retry() {\r\n      if (--tryTime >= 0) {\r\n        request()\r\n      } else {\r\n        reject(new Error('Can not get the songs url'))\r\n      }\r\n    }\r\n\r\n    request()\r\n  })\r\n}\r\n\r\nfunction commonData(module, method, param) {\r\n  return {\r\n    module: module,\r\n    method: method,\r\n    param: param\r\n  }\r\n}\r\n\r\nexport function getMusicList(topid) {\r\n  const url = 'https://c.y.qq.com/v8/fcg-bin/fcg_v8_toplist_cp.fcg'\r\n\r\n  const data = Object.assign({}, commonParams, {\r\n    topid,\r\n    needNewCode: 1,\r\n    uin: 0,\r\n    tpl: 3,\r\n    page: 'detail',\r\n    type: 'top',\r\n    platform: 'h5'\r\n  })\r\n\r\n  return jsonp(url, data, options)\r\n}\r\n","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{ref:\"rank\",staticClass:\"rank\"},[_c('scroll',{ref:\"toplist\",staticClass:\"toplist\",attrs:{\"data\":_vm.topList}},[_c('ul',_vm._l((_vm.topList),function(item,index){return _c('li',{key:index,staticClass:\"item\",on:{\"click\":function($event){return _vm.selectItem(item)}}},[_c('div',{staticClass:\"icon\"},[_c('img',{directives:[{name:\"lazy\",rawName:\"v-lazy\",value:(item.frontPicUrl),expression:\"item.frontPicUrl\"}],attrs:{\"width\":\"100\",\"height\":\"100\"}})]),_c('ul',{staticClass:\"songlist\"},[_c('h3',{staticClass:\"title\"},[_vm._v(_vm._s(item.title))]),_vm._l((item.song),function(info,index){return _c('li',{key:index,staticClass:\"song\"},[_c('span',[_vm._v(_vm._s(index+1)+\".\")]),_c('span',[_vm._v(_vm._s(info.title)+\" -\")]),_c('span',[_vm._v(_vm._s(info.singerName))])])})],2)])}),0),_c('div',{directives:[{name:\"show\",rawName:\"v-show\",value:(!_vm.topList.length),expression:\"!topList.length\"}],staticClass:\"loading-container\"},[_c('loading')],1)]),_c('router-view')],1)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\r\n  <div class=\"rank\" ref=\"rank\">\r\n    <scroll :data=\"topList\" class=\"toplist\" ref=\"toplist\">\r\n      <ul>\r\n        <li class=\"item\" v-for=\"(item,index) in topList\" :key=\"index\" @click=\"selectItem(item)\">\r\n          <div class=\"icon\">\r\n            <img width=\"100\" height=\"100\" v-lazy=\"item.frontPicUrl\" />\r\n          </div>\r\n          <ul class=\"songlist\">\r\n            <h3 class=\"title\">{{item.title}}</h3>\r\n            <li class=\"song\" v-for=\"(info,index) in item.song\" :key=\"index\">\r\n              <span>{{index+1}}.</span>\r\n              <span>{{info.title}} -</span>\r\n              <span>{{info.singerName}}</span>\r\n            </li>\r\n          </ul>\r\n        </li>\r\n      </ul>\r\n      <div class=\"loading-container\" v-show=\"!topList.length\">\r\n        <loading></loading>\r\n      </div>\r\n    </scroll>\r\n    <router-view></router-view>\r\n  </div>\r\n</template>\r\n\r\n<script type=\"text/ecmascript-6\">\r\nimport Scroll from 'base/scroll/scroll'\r\nimport Loading from 'base/loading/loading'\r\nimport { getTopList } from 'api/rank'\r\nimport { ERR_OK } from 'api/config'\r\nimport { playlistMixin } from 'common/js/mixin'\r\nimport { mapMutations } from 'vuex'\r\n\r\nexport default {\r\n  mixins: [playlistMixin],\r\n  created () {\r\n    this._getTopList()\r\n  },\r\n  data () {\r\n    return {\r\n      topList: []\r\n    }\r\n  },\r\n  methods: {\r\n    handlePlaylist (playlist) {\r\n      const bottom = playlist.length > 0 ? '60px' : 0\r\n\r\n      this.$refs.rank.style.bottom = bottom\r\n      this.$refs.toplist.refresh()\r\n    },\r\n    selectItem (item) {\r\n      this.$router.push({\r\n        path: `/rank/${item.topId}`\r\n      })\r\n      this.setTopList(item)\r\n    },\r\n    _getTopList () {\r\n      getTopList().then((res) => {\r\n        if (res.code === ERR_OK) {\r\n          let ret = []\r\n\r\n          let topListGroup = res.req_0.data.group\r\n\r\n          topListGroup.forEach((topList) => {\r\n            topList.toplist.forEach((list) => {\r\n              ret.push(list)\r\n            })\r\n          })\r\n          var info = ret.filter(function (item, index, array) {\r\n            return item.topId < 100\r\n          })\r\n          this.topList = info\r\n        }\r\n      })\r\n    },\r\n    ...mapMutations({\r\n      setTopList: 'SET_TOP_LIST'\r\n    })\r\n  },\r\n  components: {\r\n    Scroll,\r\n    Loading\r\n  }\r\n}\r\n</script>\r\n\r\n<style scoped lang=\"stylus\" rel=\"stylesheet/stylus\">\r\n@import '~common/stylus/variable'\r\n@import '~common/stylus/mixin'\r\n.rank\r\n  position fixed\r\n  width 100%\r\n  top 88px\r\n  bottom 0\r\n  .toplist\r\n    height 100%\r\n    overflow hidden\r\n    .item\r\n      display flex\r\n      margin 0 20px\r\n      padding-top 20px\r\n      height 100px\r\n      &:last-child\r\n        padding-bottom 20px\r\n      .icon\r\n        flex 0 0 100px\r\n        width 100px\r\n        height 100px\r\n      .songlist\r\n        flex 1\r\n        display flex\r\n        flex-direction column\r\n        justify-content center\r\n        padding 0 20px\r\n        height 100px\r\n        overflow hidden\r\n        background $color-highlight-background\r\n        color $color-text-d\r\n        font-size $font-size-small\r\n        .title\r\n          font-size 16px\r\n          font-weight 400\r\n          color #fff\r\n          margin 5px 0\r\n        .song\r\n          no-wrap()\r\n          line-height 26px\r\n    .loading-container\r\n      position absolute\r\n      width 100%\r\n      top 50%\r\n      transform translateY(-50%)\r\n</style>","import mod from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./rank.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./rank.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./rank.vue?vue&type=template&id=75eed9ed&scoped=true&\"\nimport script from \"./rank.vue?vue&type=script&lang=js&\"\nexport * from \"./rank.vue?vue&type=script&lang=js&\"\nimport style0 from \"./rank.vue?vue&type=style&index=0&id=75eed9ed&scoped=true&lang=stylus&rel=stylesheet%2Fstylus&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"75eed9ed\",\n  null\n  \n)\n\nexport default component.exports","import mod from \"-!../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--11-oneOf-1-0!../../../node_modules/css-loader/index.js??ref--11-oneOf-1-1!../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../node_modules/postcss-loader/src/index.js??ref--11-oneOf-1-2!../../../node_modules/stylus-loader/index.js??ref--11-oneOf-1-3!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./rank.vue?vue&type=style&index=0&id=75eed9ed&scoped=true&lang=stylus&rel=stylesheet%2Fstylus&\"; export default mod; export * from \"-!../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--11-oneOf-1-0!../../../node_modules/css-loader/index.js??ref--11-oneOf-1-1!../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../node_modules/postcss-loader/src/index.js??ref--11-oneOf-1-2!../../../node_modules/stylus-loader/index.js??ref--11-oneOf-1-3!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./rank.vue?vue&type=style&index=0&id=75eed9ed&scoped=true&lang=stylus&rel=stylesheet%2Fstylus&\""],"sourceRoot":""}