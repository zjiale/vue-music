!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define(t):(e=e||self).MouseWheel=t()}(this,function(){"use strict";var o="undefined"!=typeof window,e=o&&navigator.userAgent.toLowerCase();e&&/wechatdevtools/.test(e),e&&e.indexOf("android");function l(e,t,o){return e<t?t:o<e?o:e}var r=o&&document.createElement("div").style,t=function(){if(!o)return!1;var e={webkit:"webkitTransform",Moz:"MozTransform",O:"OTransform",ms:"msTransform",standard:"transform"};for(var t in e)if(void 0!==r[e[t]])return t;return!1}();function i(e){return!1===t?e:"standard"===t?"transitionEnd"===e?"transitionend":e:t+e.charAt(0).toUpperCase()+e.substr(1)}function n(e,t,o,r){e.addEventListener(t,o,{passive:!1,capture:!!r})}function s(e,t,o,r){e.removeEventListener(t,o,{capture:!!r})}t&&"standard"!==t&&t.toLowerCase();var a=i("transform"),h=i("transition");o&&i("perspective"),i("transitionTimingFunction"),i("transitionDuration"),i("transitionDelay"),i("transformOrigin"),i("transitionEnd");var c=o&&window;function u(){}o&&(c.requestAnimationFrame||c.webkitRequestAnimationFrame||c.mozRequestAnimationFrame||c.oRequestAnimationFrame),o&&(c.cancelAnimationFrame||c.webkitCancelAnimationFrame||c.mozCancelAnimationFrame||c.oCancelAnimationFrame);var d,m,v,p,f=(w.prototype.destroy=function(){this.removeDOMEvents(),this.events=[]},w.prototype.addDOMEvents=function(){this.handleDOMEvents(n)},w.prototype.removeDOMEvents=function(){this.handleDOMEvents(s)},w.prototype.handleDOMEvents=function(t){var o=this,r=this.wrapper;this.events.forEach(function(e){t(r,e.name,o,!!e.capture)})},w.prototype.handleEvent=function(t){var o=t.type;this.events.some(function(e){return e.name===o&&(e.handler(t),!0)})},w);function w(e,t){this.wrapper=e,this.events=t,this.addDOMEvents()}function y(e){this.scroll=e,this.wheelStart=!1,e.registerType(["mousewheelMove","mousewheelStart","mousewheelEnd"]),this.mouseWheelOpt=e.options.mouseWheel,this.deltaCache=[],this.registorEvent(),this.hooksFn=[],this.registorHooks(e.hooks,"destroy",this.destroy)}return(m=d||(d={}))[m.Positive=1]="Positive",m[m.Negative=-1]="Negative",m[m.Default=0]="Default",(p=v||(v={})).Pre="pre",p.Post="post",y.prototype.destroy=function(){this.eventRegistor.destroy(),window.clearTimeout(this.wheelEndTimer),window.clearTimeout(this.wheelMoveTimer),this.hooksFn.forEach(function(e){var t=e[0],o=e[1],r=e[2];t.off(o,r)})},y.prototype.registorEvent=function(){this.eventRegistor=new f(this.scroll.scroller.wrapper,[{name:"wheel",handler:this.wheelHandler.bind(this)},{name:"mousewheel",handler:this.wheelHandler.bind(this)},{name:"DOMMouseScroll",handler:this.wheelHandler.bind(this)}])},y.prototype.wheelHandler=function(e){this.beforeHandler(e),this.wheelStart||(this.wheelStartHandler(e),this.wheelStart=!0);var t=this.getWheelDelta(e);this.wheelMove(t),this.wheelStopDetactor(e,t)},y.prototype.wheelStartHandler=function(e){this.deltaCache=[],this.scroll.trigger(this.scroll.eventTypes.mousewheelStart)},y.prototype.wheelStopDetactor=function(e,t){var o=this;window.clearTimeout(this.wheelEndTimer);var r=this.mouseWheelOpt.throttle||400;this.wheelEndTimer=window.setTimeout(function(){o.wheelStart=!1,window.clearTimeout(o.wheelMoveTimer),o.wheelMoveTimer=0,o.scroll.trigger(o.scroll.eventTypes.mousewheelEnd,t)},r)},y.prototype.getWheelDelta=function(e){var t=this.mouseWheelOpt,o=t.speed,r=void 0===o?20:o,i=t.invert,n=0,s=0,a=void 0!==i&&i?d.Negative:d.Positive;switch(!0){case"deltaX"in e:s=1===e.deltaMode?(n=-e.deltaX*r,-e.deltaY*r):(n=-e.deltaX,-e.deltaY);break;case"wheelDeltaX"in e:n=e.wheelDeltaX/120*r,s=e.wheelDeltaY/120*r;break;case"wheelDelta"in e:n=s=e.wheelDelta/120*r;break;case"detail"in e:n=s=-e.detail/3*r}return n*=a,s*=a,this.scroll.scroller.scrollBehaviorY.hasScroll||(n=s,s=0),this.scroll.scroller.scrollBehaviorX.hasScroll||(n=0),{x:n,y:s,directionX:0<n?d.Negative:n<0?d.Positive:0,directionY:0<s?d.Negative:s<0?d.Positive:0}},y.prototype.beforeHandler=function(e){var t=this.scroll.options,o=t.preventDefault,r=t.stopPropagation,i=t.preventDefaultException;o&&!function(e,t){for(var o in t)if(t[o].test(e[o]))return!0;return!1}(e.target,i)&&e.preventDefault(),r&&e.stopPropagation()},y.prototype.wheelMove=function(e){var t=this;if(this.mouseWheelOpt.debounce&&this.wheelMoveTimer)this.deltaCache.push(e);else{var o=this.deltaCache.reduce(function(e,t){return{x:e.x+t.x,y:e.y+t.y}},{x:0,y:0});this.deltaCache=[];var r=this.scroll.x+Math.round(e.x)+o.x,i=this.scroll.y+Math.round(e.y)+o.y,n=this.scroll.scroller.scrollBehaviorX,s=this.scroll.scroller.scrollBehaviorY;if(r=l(r,n.maxScrollPos,n.minScrollPos),i=l(i,s.maxScrollPos,s.minScrollPos),!this.scroll.trigger(this.scroll.eventTypes.mousewheelMove,{x:r,y:i})){var a=this.getEaseTime();r===this.scroll.x&&i===this.scroll.y||this.scroll.scrollTo(r,i,a)}this.mouseWheelOpt.debounce&&(this.wheelMoveTimer=window.setTimeout(function(){t.wheelMoveTimer=0},this.mouseWheelOpt.debounce))}},y.prototype.registorHooks=function(e,t,o){e.on(t,o,this),this.hooksFn.push([e,t,o])},y.prototype.getEaseTime=function(){var e=this.mouseWheelOpt.easeTime||300;return e<100&&function(e){console.error("[BScroll warn]: "+e)}("easeTime should be greater than 100.\n      If mouseWheel easeTime is too small, scrollEnd will be triggered many times."),e},y.pluginName="mouseWheel",y.enforce=v.Pre,y});
