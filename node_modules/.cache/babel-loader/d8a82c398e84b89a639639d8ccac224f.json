{"remainingRequest":"E:\\vue-music\\node_modules\\thread-loader\\dist\\cjs.js!E:\\vue-music\\node_modules\\babel-loader\\lib\\index.js!E:\\vue-music\\node_modules\\cache-loader\\dist\\cjs.js??ref--0-0!E:\\vue-music\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!E:\\vue-music\\src\\base\\listview\\listview.vue?vue&type=script&lang=js&","dependencies":[{"path":"E:\\vue-music\\src\\base\\listview\\listview.vue","mtime":1570504427873},{"path":"E:\\vue-music\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"E:\\vue-music\\node_modules\\thread-loader\\dist\\cjs.js","mtime":499162500000},{"path":"E:\\vue-music\\node_modules\\babel-loader\\lib\\index.js","mtime":499162500000},{"path":"E:\\vue-music\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"E:\\vue-music\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":["import \"core-js/modules/es6.string.fixed\";\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\nimport Scroll from 'base/scroll/scroll';\nimport Loading from 'base/loading/loading';\nimport { getData } from 'common/js/dom';\nvar ANCHOR_HEIGHT = 18;\nvar TITLE_HEIGHT = 30;\nexport default {\n  created: function created() {\n    this.touch = {};\n    this.listenScroll = true;\n    this.listHeight = [];\n    this.probeType = 3;\n  },\n  data: function data() {\n    return {\n      scrollY: -1,\n      currentIndex: 0,\n      diff: -1\n    };\n  },\n  props: {\n    data: {\n      type: Array,\n      default: function _default() {\n        return [];\n      }\n    }\n  },\n  computed: {\n    shortcutList: function shortcutList() {\n      // map() 方法返回一个新数组，数组中的元素为原始数组元素调用函数处理后的值\n      return this.data.map(function (group) {\n        return group.title.substr(0, 1);\n      });\n    },\n    fixedTitle: function fixedTitle() {\n      if (this.scrollY > 0) {\n        return '';\n      }\n\n      return this.data[this.currentIndex] ? this.data[this.currentIndex].title : '';\n    }\n  },\n  methods: {\n    selectItem: function selectItem(item) {\n      this.$emit('select', item);\n    },\n    onShortcutTouchStart: function onShortcutTouchStart(e) {\n      var anchorIndex = getData(e.target, 'index');\n      var firstTouch = e.touches[0];\n      this.touch.y1 = firstTouch.pageY;\n      this.touch.anchorIndex = anchorIndex; // 右侧得滑动入口index和左边得listgroup得index相等才能跳到相应的区块\n\n      this._scrollTo(anchorIndex);\n    },\n    onShortcutTouchMove: function onShortcutTouchMove(e) {\n      var firstTouch = e.touches[0];\n      this.touch.y2 = firstTouch.pageY; // |0为向下取整,delta为偏移得锚点个数\n\n      var delta = (this.touch.y2 - this.touch.y1) / ANCHOR_HEIGHT | 0; // anchorIndex为最终得移动终点\n\n      var anchorIndex = parseInt(this.touch.anchorIndex) + delta;\n\n      this._scrollTo(anchorIndex);\n    },\n    refresh: function refresh() {\n      this.$refs.listview.refresh();\n    },\n    scroll: function scroll(pos) {\n      this.scrollY = pos.y;\n    },\n    _scrollTo: function _scrollTo(index) {\n      if (!index && index !== 0) {\n        return;\n      }\n\n      if (index < 0) {\n        index = 0;\n      } else if (index > this.listHeight.length - 2) {\n        index = this.listHeight.length - 2;\n      }\n\n      this.scrollY = -this.listHeight[index];\n      this.$refs.listview.scrollToElement(this.$refs.listGroup[index], 0);\n    },\n    _calculateHeight: function _calculateHeight() {\n      this.listHeight = [];\n      var list = this.$refs.listGroup;\n      var height = 0;\n      this.listHeight.push(height);\n\n      for (var i = 0; i < list.length; i++) {\n        var item = list[i];\n        height += item.clientHeight;\n        this.listHeight.push(height);\n      }\n    }\n  },\n  watch: {\n    data: function data() {\n      var _this = this;\n\n      setTimeout(function () {\n        _this._calculateHeight();\n      }, 20);\n    },\n    scrollY: function scrollY(newY) {\n      var listHeight = this.listHeight; // 挡滚动到顶部 newY>0\n\n      if (newY > 0) {\n        this.currentIndex = 0;\n        return;\n      } // 在中间部分滚动\n\n\n      for (var i = 0; i < listHeight.length - 1; i++) {\n        var height1 = listHeight[i];\n        var height2 = listHeight[i + 1];\n        /*\r\n          !height2为滑动到最后一个没有下限了\r\n          -newY为往上滑动时值是为负数所以要加“-”\r\n        */\n\n        if (-newY >= height1 && -newY < height2) {\n          this.currentIndex = i;\n          this.diff = height2 + newY;\n          return;\n        }\n      } // 当滚动到底部，且-newY大于最后一个元素得上限\n\n\n      this.currentIndex = listHeight.length - 2;\n    },\n    diff: function diff(newVal) {\n      var fixedTop = newVal > 0 && newVal < TITLE_HEIGHT ? newVal - TITLE_HEIGHT : 0;\n\n      if (this.fixedTop === fixedTop) {\n        return;\n      }\n\n      this.fixedTop = fixedTop;\n      this.$refs.fixed.style.transform = \"translate3d(0, \".concat(fixedTop, \"px, 0)\");\n    }\n  },\n  components: {\n    Scroll: Scroll,\n    Loading: Loading\n  }\n};",{"version":3,"sources":["listview.vue"],"names":[],"mappings":"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","sourcesContent":["<template>\r\n  <scroll\r\n    class=\"listview\"\r\n    :data=\"data\"\r\n    ref=\"listview\"\r\n    :listenScroll=\"listenScroll\"\r\n    :probeType=\"probeType\"\r\n    @scroll=\"scroll\"\r\n  >\r\n    <ul>\r\n      <li v-for=\"(group, index) in data\" :key=\"index\" class=\"list-group\" ref=\"listGroup\">\r\n        <h2 class=\"list-group-title\">{{group.title}}</h2>\r\n        <ul>\r\n          <li\r\n            @click=\"selectItem(item)\"\r\n            v-for=\"item in group.items\"\r\n            :key=\"item.id\"\r\n            class=\"list-group-item\"\r\n          >\r\n            <img class=\"avatar\" v-lazy=\"item.avatar\" />\r\n            <span class=\"name\">{{item.name}}</span>\r\n          </li>\r\n        </ul>\r\n      </li>\r\n    </ul>\r\n    <div\r\n      class=\"list-shortcut\"\r\n      @touchstart=\"onShortcutTouchStart\"\r\n      @touchmove.stop.prevent=\"onShortcutTouchMove\"\r\n    >\r\n      <ul>\r\n        <li\r\n          v-for=\"(item, index) in shortcutList\"\r\n          :key=\"index\"\r\n          class=\"item\"\r\n          :class=\"{'current': currentIndex === index}\"\r\n          :data-index=\"index\"\r\n        >{{item}}</li>\r\n      </ul>\r\n    </div>\r\n    <div class=\"list-fixed\" v-show=\"fixedTitle\" ref=\"fixed\">\r\n      <h1 class=\"fixed-title\">{{fixedTitle}}</h1>\r\n    </div>\r\n    <div v-show=\"!data.length\" class=\"loading-container\">\r\n      <loading></loading>\r\n    </div>\r\n  </scroll>\r\n</template>\r\n\r\n<script type=\"text/ecmascript-6\">\r\nimport Scroll from 'base/scroll/scroll'\r\nimport Loading from 'base/loading/loading'\r\nimport { getData } from 'common/js/dom'\r\n\r\nconst ANCHOR_HEIGHT = 18\r\nconst TITLE_HEIGHT = 30\r\n\r\nexport default {\r\n  created () {\r\n    this.touch = {}\r\n    this.listenScroll = true\r\n    this.listHeight = []\r\n    this.probeType = 3\r\n  },\r\n  data () {\r\n    return {\r\n      scrollY: -1,\r\n      currentIndex: 0,\r\n      diff: -1\r\n    }\r\n  },\r\n  props: {\r\n    data: {\r\n      type: Array,\r\n      default: () => []\r\n    }\r\n  },\r\n  computed: {\r\n    shortcutList () {\r\n      // map() 方法返回一个新数组，数组中的元素为原始数组元素调用函数处理后的值\r\n      return this.data.map((group) => {\r\n        return group.title.substr(0, 1)\r\n      })\r\n    },\r\n    fixedTitle () {\r\n      if (this.scrollY > 0) {\r\n        return ''\r\n      }\r\n      return this.data[this.currentIndex] ? this.data[this.currentIndex].title : ''\r\n    }\r\n  },\r\n  methods: {\r\n    selectItem (item) {\r\n      this.$emit('select', item)\r\n    },\r\n    onShortcutTouchStart (e) {\r\n      let anchorIndex = getData(e.target, 'index')\r\n      let firstTouch = e.touches[0]\r\n      this.touch.y1 = firstTouch.pageY\r\n      this.touch.anchorIndex = anchorIndex\r\n      // 右侧得滑动入口index和左边得listgroup得index相等才能跳到相应的区块\r\n      this._scrollTo(anchorIndex)\r\n    },\r\n    onShortcutTouchMove (e) {\r\n      let firstTouch = e.touches[0]\r\n      this.touch.y2 = firstTouch.pageY\r\n      // |0为向下取整,delta为偏移得锚点个数\r\n      let delta = (this.touch.y2 - this.touch.y1) / ANCHOR_HEIGHT | 0\r\n      // anchorIndex为最终得移动终点\r\n      let anchorIndex = parseInt(this.touch.anchorIndex) + delta\r\n      this._scrollTo(anchorIndex)\r\n    },\r\n    refresh () {\r\n      this.$refs.listview.refresh()\r\n    },\r\n    scroll (pos) {\r\n      this.scrollY = pos.y\r\n    },\r\n    _scrollTo (index) {\r\n      if (!index && index !== 0) {\r\n        return\r\n      }\r\n      if (index < 0) {\r\n        index = 0\r\n      } else if (index > this.listHeight.length - 2) {\r\n        index = this.listHeight.length - 2\r\n      }\r\n      this.scrollY = -this.listHeight[index]\r\n      this.$refs.listview.scrollToElement(this.$refs.listGroup[index], 0)\r\n    },\r\n    _calculateHeight () {\r\n      this.listHeight = []\r\n      const list = this.$refs.listGroup\r\n      let height = 0\r\n      this.listHeight.push(height)\r\n      for (let i = 0; i < list.length; i++) {\r\n        let item = list[i]\r\n        height += item.clientHeight\r\n        this.listHeight.push(height)\r\n      }\r\n    }\r\n  },\r\n  watch: {\r\n    data () {\r\n      setTimeout(() => {\r\n        this._calculateHeight()\r\n      }, 20)\r\n    },\r\n    scrollY (newY) {\r\n      const listHeight = this.listHeight\r\n      // 挡滚动到顶部 newY>0\r\n      if (newY > 0) {\r\n        this.currentIndex = 0\r\n        return\r\n      }\r\n      // 在中间部分滚动\r\n      for (let i = 0; i < listHeight.length - 1; i++) {\r\n        let height1 = listHeight[i]\r\n        let height2 = listHeight[i + 1]\r\n        /*\r\n          !height2为滑动到最后一个没有下限了\r\n          -newY为往上滑动时值是为负数所以要加“-”\r\n        */\r\n        if (-newY >= height1 && -newY < height2) {\r\n          this.currentIndex = i\r\n          this.diff = height2 + newY\r\n          return\r\n        }\r\n      }\r\n      // 当滚动到底部，且-newY大于最后一个元素得上限\r\n      this.currentIndex = listHeight.length - 2\r\n    },\r\n    diff (newVal) {\r\n      let fixedTop = (newVal > 0 && newVal < TITLE_HEIGHT) ? newVal - TITLE_HEIGHT : 0\r\n      if (this.fixedTop === fixedTop) {\r\n        return\r\n      }\r\n      this.fixedTop = fixedTop\r\n      this.$refs.fixed.style.transform = `translate3d(0, ${fixedTop}px, 0)`\r\n    }\r\n  },\r\n  components: {\r\n    Scroll,\r\n    Loading\r\n  }\r\n}\r\n</script>\r\n\r\n<style scoped lang=\"stylus\" rel=\"stylesheet/stylus\">\r\n@import '~common/stylus/variable'\r\n.listview\r\n  position relative\r\n  width 100%\r\n  height 100%\r\n  overflow hidden\r\n  background $color-background\r\n  .list-group\r\n    padding-bottom 30px\r\n    .list-group-title\r\n      height 30px\r\n      line-height 30px\r\n      padding-left 20px\r\n      font-size $font-size-small\r\n      color $color-text-l\r\n      background $color-highlight-background\r\n    .list-group-item\r\n      display flex\r\n      align-items center\r\n      padding 20px 0 0 30px\r\n      .avatar\r\n        width 50px\r\n        height 50px\r\n        border-radius 50%\r\n      .name\r\n        margin-left 20px\r\n        color $color-text-l\r\n        font-size $font-size-medium\r\n  .list-shortcut\r\n    position absolute\r\n    z-index 30\r\n    right 0\r\n    top 50%\r\n    transform translateY(-50%)\r\n    width 20px\r\n    padding 20px 0\r\n    border-radius 10px\r\n    text-align center\r\n    background $color-background-d\r\n    font-family Helvetica\r\n    .item\r\n      padding 3px\r\n      line-height 1\r\n      color $color-text-l\r\n      font-size $font-size-small\r\n      &.current\r\n        color $color-theme\r\n  .list-fixed\r\n    position absolute\r\n    top 0\r\n    left 0\r\n    width 100%\r\n    .fixed-title\r\n      height 30px\r\n      line-height 30px\r\n      padding-left 20px\r\n      font-size $font-size-small\r\n      color $color-text-l\r\n      background $color-highlight-background\r\n  .loading-container\r\n    position absolute\r\n    width 100%\r\n    top 50%\r\n    transform translateY(-50%)\r\n</style>\r\n"],"sourceRoot":"src/base/listview"}]}