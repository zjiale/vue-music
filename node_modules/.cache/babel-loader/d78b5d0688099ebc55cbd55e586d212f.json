{"remainingRequest":"E:\\vue-music\\node_modules\\babel-loader\\lib\\index.js!E:\\vue-music\\node_modules\\eslint-loader\\index.js??ref--13-0!E:\\vue-music\\src\\common\\js\\song.js","dependencies":[{"path":"E:\\vue-music\\src\\common\\js\\song.js","mtime":1571279241444},{"path":"E:\\vue-music\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"E:\\vue-music\\node_modules\\babel-loader\\lib\\index.js","mtime":499162500000},{"path":"E:\\vue-music\\node_modules\\eslint-loader\\index.js","mtime":499162500000}],"contextDependencies":[],"result":["import \"core-js/modules/web.dom.iterable\";\nimport \"core-js/modules/es6.function.name\";\nimport _classCallCheck from \"E:\\\\vue-music\\\\node_modules\\\\@babel\\\\runtime-corejs2/helpers/esm/classCallCheck\";\nimport _createClass from \"E:\\\\vue-music\\\\node_modules\\\\@babel\\\\runtime-corejs2/helpers/esm/createClass\";\nimport { getLyric as _getLyric, getSongsUrl } from 'api/song';\nimport { ERR_OK } from 'api/config';\nimport { Base64 } from 'js-base64';\n\nvar Song =\n/*#__PURE__*/\nfunction () {\n  function Song(_ref) {\n    var id = _ref.id,\n        mid = _ref.mid,\n        singer = _ref.singer,\n        name = _ref.name,\n        album = _ref.album,\n        duration = _ref.duration,\n        image = _ref.image,\n        url = _ref.url;\n\n    _classCallCheck(this, Song);\n\n    this.id = id;\n    this.mid = mid;\n    this.singer = singer;\n    this.name = name;\n    this.album = album;\n    this.duration = duration;\n    this.image = image;\n    this.url = url;\n  }\n\n  _createClass(Song, [{\n    key: \"getLyric\",\n    value: function getLyric() {\n      var _this = this;\n\n      if (this.lyric) {\n        return Promise.resolve(this.lyric);\n      }\n\n      return new Promise(function (resolve, reject) {\n        _getLyric(_this.mid).then(function (res) {\n          if (res.retcode === ERR_OK) {\n            _this.lyric = Base64.decode(res.lyric);\n            resolve(_this.lyric);\n          } else {\n            reject(new Error('no lyric'));\n          }\n        });\n      });\n    }\n  }]);\n\n  return Song;\n}();\n\nexport { Song as default };\nexport function createSong(musicData) {\n  return new Song({\n    id: musicData.songid,\n    mid: musicData.songmid,\n    singer: filterSinger(musicData.singer),\n    name: musicData.songname,\n    album: musicData.albumname,\n    duration: musicData.interval,\n    image: \"https://y.gtimg.cn/music/photo_new/T002R300x300M000\".concat(musicData.albummid, \".jpg?max_age=2592000\"),\n    url: musicData.url\n  });\n}\n\nfunction filterSinger(singer) {\n  var ret = [];\n\n  if (!singer) {\n    return '';\n  }\n\n  singer.forEach(function (s) {\n    ret.push(s.name);\n  });\n  return ret.join('/');\n}\n\nexport function isValidMusic(musicData) {\n  return musicData.songid && musicData.albummid && (!musicData.pay || musicData.pay.payalbumprice === 0);\n}\nexport function processSongUrl(songs) {\n  if (!songs.length) {\n    return Promise.resolve(songs);\n  }\n\n  return getSongsUrl(songs).then(function (purlMap) {\n    songs = songs.filter(function (song) {\n      var purl = purlMap[song.mid];\n\n      if (purl) {\n        song.url = purl.indexOf('http') === -1 ? \"http://dl.stream.qqmusic.qq.com/\".concat(purl) : purl;\n        return true;\n      }\n\n      return false;\n    });\n    return songs;\n  });\n}",{"version":3,"sources":["E:\\vue-music\\src\\common\\js\\song.js"],"names":["getLyric","getSongsUrl","ERR_OK","Base64","Song","id","mid","singer","name","album","duration","image","url","lyric","Promise","resolve","reject","then","res","retcode","decode","Error","createSong","musicData","songid","songmid","filterSinger","songname","albumname","interval","albummid","ret","forEach","s","push","join","isValidMusic","pay","payalbumprice","processSongUrl","songs","length","purlMap","filter","song","purl","indexOf"],"mappings":"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","sourcesContent":["import {\r\n  getLyric,\r\n  getSongsUrl\r\n} from 'api/song'\r\nimport {\r\n  ERR_OK\r\n} from 'api/config'\r\nimport {\r\n  Base64\r\n} from 'js-base64'\r\n\r\nexport default class Song {\r\n  constructor({\r\n    id,\r\n    mid,\r\n    singer,\r\n    name,\r\n    album,\r\n    duration,\r\n    image,\r\n    url\r\n  }) {\r\n    this.id = id\r\n    this.mid = mid\r\n    this.singer = singer\r\n    this.name = name\r\n    this.album = album\r\n    this.duration = duration\r\n    this.image = image\r\n    this.url = url\r\n  }\r\n\r\n  getLyric() {\r\n    if (this.lyric) {\r\n      return Promise.resolve(this.lyric)\r\n    }\r\n    return new Promise((resolve, reject) => {\r\n      getLyric(this.mid).then((res) => {\r\n        if (res.retcode === ERR_OK) {\r\n          this.lyric = Base64.decode(res.lyric)\r\n          resolve(this.lyric)\r\n        } else {\r\n          reject(new Error('no lyric'))\r\n        }\r\n      })\r\n    })\r\n  }\r\n}\r\n\r\nexport function createSong(musicData) {\r\n  return new Song({\r\n    id: musicData.songid,\r\n    mid: musicData.songmid,\r\n    singer: filterSinger(musicData.singer),\r\n    name: musicData.songname,\r\n    album: musicData.albumname,\r\n    duration: musicData.interval,\r\n    image: `https://y.gtimg.cn/music/photo_new/T002R300x300M000${musicData.albummid}.jpg?max_age=2592000`,\r\n    url: musicData.url\r\n  })\r\n}\r\n\r\nfunction filterSinger(singer) {\r\n  let ret = []\r\n  if (!singer) {\r\n    return ''\r\n  }\r\n  singer.forEach((s) => {\r\n    ret.push(s.name)\r\n  })\r\n  return ret.join('/')\r\n}\r\n\r\nexport function isValidMusic(musicData) {\r\n  return musicData.songid && musicData.albummid && (!musicData.pay || musicData.pay.payalbumprice === 0)\r\n}\r\n\r\nexport function processSongUrl(songs) {\r\n  if (!songs.length) {\r\n    return Promise.resolve(songs)\r\n  }\r\n  return getSongsUrl(songs).then((purlMap) => {\r\n    songs = songs.filter((song) => {\r\n      const purl = purlMap[song.mid]\r\n      if (purl) {\r\n        song.url = purl.indexOf('http') === -1 ? `http://dl.stream.qqmusic.qq.com/${purl}` : purl\r\n        return true\r\n      }\r\n      return false\r\n    })\r\n    return songs\r\n  })\r\n}\r\n"]}]}