{"remainingRequest":"E:\\vue-music\\node_modules\\babel-loader\\lib\\index.js!E:\\vue-music\\node_modules\\cache-loader\\dist\\cjs.js??ref--0-0!E:\\vue-music\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!E:\\vue-music\\src\\components\\music-video\\music-video.vue?vue&type=script&lang=js&","dependencies":[{"path":"E:\\vue-music\\src\\components\\music-video\\music-video.vue","mtime":1572602295376},{"path":"E:\\vue-music\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"E:\\vue-music\\node_modules\\babel-loader\\lib\\index.js","mtime":499162500000},{"path":"E:\\vue-music\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"E:\\vue-music\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":["import \"core-js/modules/es7.object.get-own-property-descriptors\";\nimport \"core-js/modules/es6.object.keys\";\nimport \"core-js/modules/web.dom.iterable\";\nimport _defineProperty from \"E:\\\\vue-music\\\\node_modules\\\\@babel\\\\runtime-corejs2/helpers/esm/defineProperty\";\n\nfunction ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys(source, true).forEach(function (key) { _defineProperty(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { ownKeys(source).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }\n\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\nimport { getMvList, getMvUrl } from 'api/mv';\nimport { createMv } from 'common/js/mv';\nimport { playlistMixin } from 'common/js/mixin';\nimport { mapMutations, mapGetters } from 'vuex';\nimport Singer from 'common/js/singer';\nimport BaseVideo from 'base/base-video/base-video';\nimport Scroll from 'base/scroll/scroll';\nexport default {\n  mixins: [playlistMixin],\n  data: function data() {\n    return {\n      mvList: [],\n      mvHeight: 0\n    };\n  },\n  created: function created() {\n    this._getMvList();\n  },\n  computed: _objectSpread({}, mapGetters(['playing'])),\n  methods: _objectSpread({\n    handlePlaylist: function handlePlaylist(playlist) {\n      var bottom = playlist.length > 0 ? '60px' : 0;\n      this.$refs.videoContent.style.bottom = bottom;\n      this.$refs.videoList.refresh();\n    },\n    selectSinger: function selectSinger(item) {\n      var singer = new Singer({\n        id: item.sid,\n        name: item.singer\n      });\n      this.$router.push({\n        path: \"/singer/\".concat(item.sid)\n      });\n      this.setSinger(singer);\n    },\n    play: function play() {\n      if (this.playing) {\n        this.setPlayingState(!this.playing);\n      }\n    },\n    _getMvList: function _getMvList() {\n      var _this = this;\n\n      getMvList().then(function (res) {\n        var list = res.data.mv.list;\n        getMvUrl(list).then(function (res) {\n          _this.mvList = _this._normalizeMv(list, res);\n        });\n      });\n    },\n    // list为mv相关的信息，res为mv的地址和vid信息\n    _normalizeMv: function _normalizeMv(list, res) {\n      var ret = [];\n      var result = [];\n      var mvList = [];\n      var vkeys = res.getMvUrl.data;\n\n      for (var key in vkeys) {\n        ret.push({\n          vid: key,\n          url: vkeys[key].mp4[1].freeflow_url[0]\n        });\n      }\n\n      list.forEach(function (item) {\n        ret.forEach(function (res) {\n          if (item.v_id === res.vid) {\n            result.push({\n              mv_id: item.mv_id,\n              mv_name: item.mv_name,\n              mv_pic_url: item.mv_pic_url,\n              singer_name: item.singer_name,\n              singerMID: item.singerMID,\n              v_id: item.v_id,\n              url: res.url\n            });\n          }\n        });\n      });\n      result.forEach(function (item) {\n        mvList.push(createMv(item));\n      });\n      return mvList;\n    },\n    _calculateHeight: function _calculateHeight() {\n      var item = this.$refs.item;\n      var offsetHeight = 0;\n\n      for (var i = 0; i < item.length; i++) {\n        var mv = item[i];\n        offsetHeight = mv.offsetHeight;\n      }\n\n      return offsetHeight;\n    }\n  }, mapMutations({\n    setSinger: 'SET_SINGER',\n    setPlayingState: 'SET_PLAYING_STATE',\n    setVideoState: 'SET_VIDEO_STATE'\n  })),\n  watch: {\n    // 异步加载的数据需要在watch观察数据然后再进行dom操作\n    mvList: function mvList() {\n      var _this2 = this;\n\n      setTimeout(function () {\n        _this2.mvHeight = _this2._calculateHeight();\n      }, 20);\n    }\n  },\n  components: {\n    BaseVideo: BaseVideo,\n    Scroll: Scroll\n  }\n};",{"version":3,"sources":["music-video.vue"],"names":[],"mappings":"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","sourcesContent":["<template>\r\n  <div class=\"video-cotent\" ref=\"videoContent\">\r\n    <scroll ref=\"videoList\" class=\"video-list\" :data=\"mvList\">\r\n      <ul>\r\n        <li class=\"item\" ref=\"item\" v-for=\"item in mvList\" :key=\"item.vid\">\r\n          <base-video :vid=\"item.vid\" :src=\"item.url\" :poster=\"item.image\" @play=\"play\"></base-video>\r\n          <div class=\"video-info\">\r\n            <div class=\"singer\" @click=\"selectSinger(item)\">\r\n              <img class=\"avatar\" v-lazy=\"item.avatar\" />\r\n              <span class=\"name\" v-html=\"item.singer\"></span>\r\n            </div>\r\n            <span class=\"song\" v-html=\"item.name\"></span>\r\n          </div>\r\n        </li>\r\n      </ul>\r\n    </scroll>\r\n  </div>\r\n</template>\r\n\r\n<script type=\"text/ecmascript-6\">\r\nimport { getMvList, getMvUrl } from 'api/mv'\r\nimport { createMv } from 'common/js/mv'\r\nimport { playlistMixin } from 'common/js/mixin'\r\nimport { mapMutations, mapGetters } from 'vuex'\r\nimport Singer from 'common/js/singer'\r\nimport BaseVideo from 'base/base-video/base-video'\r\nimport Scroll from 'base/scroll/scroll'\r\n\r\nexport default {\r\n  mixins: [playlistMixin],\r\n  data () {\r\n    return {\r\n      mvList: [],\r\n      mvHeight: 0\r\n    }\r\n  },\r\n  created () {\r\n    this._getMvList()\r\n  },\r\n  computed: {\r\n    ...mapGetters(([\r\n      'playing'\r\n    ]))\r\n  },\r\n  methods: {\r\n    handlePlaylist (playlist) {\r\n      const bottom = playlist.length > 0 ? '60px' : 0\r\n\r\n      this.$refs.videoContent.style.bottom = bottom\r\n      this.$refs.videoList.refresh()\r\n    },\r\n    selectSinger (item) {\r\n      let singer = new Singer({\r\n        id: item.sid,\r\n        name: item.singer\r\n      })\r\n      this.$router.push({\r\n        path: `/singer/${item.sid}`\r\n      })\r\n      this.setSinger(singer)\r\n    },\r\n    play () {\r\n      if (this.playing) {\r\n        this.setPlayingState(!this.playing)\r\n      }\r\n    },\r\n    _getMvList () {\r\n      getMvList().then((res) => {\r\n        let { list } = res.data.mv\r\n        getMvUrl(list).then((res) => {\r\n          this.mvList = this._normalizeMv(list, res)\r\n        })\r\n      })\r\n    },\r\n    // list为mv相关的信息，res为mv的地址和vid信息\r\n    _normalizeMv (list, res) {\r\n      let ret = []\r\n      let result = []\r\n      let mvList = []\r\n      let vkeys = res.getMvUrl.data\r\n      for (var key in vkeys) {\r\n        ret.push({\r\n          vid: key,\r\n          url: vkeys[key].mp4[1].freeflow_url[0]\r\n        })\r\n      }\r\n      list.forEach((item) => {\r\n        ret.forEach((res) => {\r\n          if (item.v_id === res.vid) {\r\n            result.push({\r\n              mv_id: item.mv_id,\r\n              mv_name: item.mv_name,\r\n              mv_pic_url: item.mv_pic_url,\r\n              singer_name: item.singer_name,\r\n              singerMID: item.singerMID,\r\n              v_id: item.v_id,\r\n              url: res.url\r\n            })\r\n          }\r\n        })\r\n      })\r\n      result.forEach((item) => {\r\n        mvList.push(createMv(item))\r\n      })\r\n      return mvList\r\n    },\r\n    _calculateHeight () {\r\n      const item = this.$refs.item\r\n      let offsetHeight = 0\r\n      for (let i = 0; i < item.length; i++) {\r\n        let mv = item[i]\r\n        offsetHeight = mv.offsetHeight\r\n      }\r\n      return offsetHeight\r\n    },\r\n    ...mapMutations({\r\n      setSinger: 'SET_SINGER',\r\n      setPlayingState: 'SET_PLAYING_STATE',\r\n      setVideoState: 'SET_VIDEO_STATE'\r\n    })\r\n  },\r\n  watch: {\r\n    // 异步加载的数据需要在watch观察数据然后再进行dom操作\r\n    mvList () {\r\n      setTimeout(() => {\r\n        this.mvHeight = this._calculateHeight()\r\n      }, 20)\r\n    }\r\n  },\r\n  components: {\r\n    BaseVideo,\r\n    Scroll\r\n  }\r\n}\r\n\r\n</script>\r\n\r\n<style scoped lang=\"stylus\" rel=\"stylesheet/stylus\">\r\n@import '~common/stylus/variable'\r\n.video-cotent\r\n  position fixed\r\n  width 100%\r\n  top 88px\r\n  bottom 0\r\n  .video-list\r\n    height 100%\r\n    overflow hidden\r\n    .item\r\n      display flex\r\n      flex-direction column\r\n      padding-top 15px\r\n      &:last-child\r\n        padding-bottom 10px\r\n      .video-info\r\n        display flex\r\n        justify-content space-between\r\n        align-items center\r\n        margin-top 8px\r\n        padding 0 10px\r\n        font-size $font-size-medium\r\n        color $color-theme\r\n        .singer\r\n          display flex\r\n          align-items center\r\n          .avatar\r\n            width 28px\r\n            height 28px\r\n            border-radius 50%\r\n            margin-right 5px\r\n</style>"],"sourceRoot":"src/components/music-video"}]}